/*! cpmui 14-12-2015 */
!function(a){a.cpm={}}(window.vw=window.vw||{}),function(a){a.cpm.CLI=function(b,c){this.options=c,this.view=new a.cpm.CLIView(this,b),this.init()},a.cpm.CLI.prototype.init=function(){this.foo="bar",store.enabled||alert('Local storage is not supported by your browser. Please disable "Private Mode", or upgrade to a modern browser. Your session won\'t be saved across page reloads'),console.log(store.get("test")),store.set("test",this.view.panels),this.activemenu="",this.menus={"default":{title:"Corpus & Process Manager",body:$("<div></div>")},"corpus-menu":{title:"Corpora",body:$("<div></div>")},"module-menu":{title:"Modules",body:$("<div></div>")},"process-menu":{title:"Process",body:$("<div></div>")},"settings-menu":{title:"Settings",body:$("<div></div>")},"help-menu":{title:"Help",body:$("<div></div>")}},this.cpmsettingsmanager=new a.cpm.CPMSettingsManager(this,this.menus["settings-menu"].body),this.helpmanager=new a.cpm.HelpManager(this,this.menus["help-menu"].body),this.modulesmanager=new a.cpm.ModuleManager(this,this.menus["module-menu"].body),this.corpusmanager=new a.cpm.CorpusManager(this,this.menus["corpus-menu"].body),this.processmanager=new a.cpm.ProcessManager(this,this.menus["process-menu"].body);var b=store.get("firstrun");if(b)var c=this.view.createPanel("Intro",this.helpmanager.slides);else{var c=this.view.createPanel("Intro",this.helpmanager.slides);this.view.fullscreen(c),store.set("firstrun","done")}},a.cpm.CLI.prototype.setActiveMenu=function(a){this.view.$el.find("#menu-content-title").empty(),this.view.$el.find("#menu-content-body").children().detach();var b=this.menus[a];this.view.$el.find("#menu-content-title").append(b.title),this.view.$el.find("#menu-content-body").append(b.body)},a.cpm.CLI.prototype.cpmRawCall=function(a,b){var c=this;$.ajax({type:"POST",data:{cmd:a},url:c.options.cpmbaseurl+"rest/cmd",success:function(a,d,e){b.call(c,a)},error:function(){}})},a.cpm.CLI.prototype.cpmCall=function(a,b){var c=this;$.ajax({type:"POST",data:{cmd:a+" --json"},url:c.options.cpmbaseurl+"rest/cmd",dataType:"json",success:function(a,d,e){b.call(c,a)},error:function(){}})},a.cpm.CLI.prototype.request=function(a){var b=this;if("brat"==a)return $panel=b.view.getPanel("brat"),$panel.find(".frame-body").empty(),void $panel.find(".frame-body").append('<iframe width="100%" height="500px" src="http://192.168.1.27:8001/index.xhtml"></iframe>');if(a.startsWith("file")){var c=a.split(" ");return void $.ajax({type:"POST",data:{file:c[1]},url:b.options.cpmbaseurl+"rest/file",success:function(c,d,e){b.view.createPanel(a,c)},error:function(){}})}b.cpmRawCall(a,function(c){b.view.createPanel(a,c),console.log(c)})},a.cpm.CLI.prototype.cpmSettings=function(){}}(window.vw=window.vw||{}),function(a){a.cpm.ui={}}(window.vw=window.vw||{}),function(a){a.cpm.utils={},a.cpm.utils.guids=[],a.cpm.utils.guid=function(){function b(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}for(var c=b()+b()+"-"+b()+"-"+b()+"-"+b()+"-"+b()+b()+b();-1!=a.cpm.utils.guids.indexOf(c);)c=b()+b()+"-"+b()+"-"+b()+"-"+b()+"-"+b()+b()+b();return a.cpm.utils.guids.push(c),c},a.cpm.utils.getSelectionText=function(){var a="";return window.getSelection?a=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(a=document.selection.createRange().text),a}}(window.vw=window.vw||{}),function(a){a.cpm.CorpusManager=function(b,c,d){this.options=d,this.app=b,this.view=new a.cpm.CorpusManagerView(this,c),this.filetree={},this.init()},a.cpm.CorpusManager.prototype.init=function(){var a=this;a.fetch()},a.cpm.CorpusManager.prototype.fetch=function(){var a=this;$.ajax({type:"POST",url:a.app.options.cpmbaseurl+"rest/cmd",data:{cmd:"corpus ls --json"},dataType:"json",success:function(b,c,d){a.filetree={"/":b.corpus},a.view.refresh()}})}}(window.vw=window.vw||{}),function(a){a.cpm.CPMSettingsManager=function(b,c,d){this.options=d,this.app=b,this.view=new a.cpm.CPMSettingsManagerView(this,c),this.cpmsettings={},this.init()},a.cpm.CPMSettingsManager.prototype.init=function(){var a=this;a.fetch()},a.cpm.CPMSettingsManager.prototype.fetch=function(){var a=this;this.app.cpmCall("settings",function(b){a.cpmsettings=b,a.view.render()})}}(window.vw=window.vw||{}),function(a){a.cpm.HelpManager=function(b,c,d){this.options=d,this.app=b,this.view=new a.cpm.HelpManagerView(this,c),this.init()},a.cpm.HelpManager.prototype.init=function(){this.slides='<iframe style="border-style:none;border:0;margin:0;padding:0;" height="500px" width="100%" src="http://localhost/cpm/public/vendor/reveal.js-3.2.0/index.html"></iframe>'}}(window.vw=window.vw||{}),function(a){a.cpm.Module=function(b,c,d){this.def=d,this.app=b,this.view=new a.cpm.ModuleView(this,c),this.synced=!1},a.cpm.Module.prototype.init=function(){},a.cpm.Module.prototype.fetch=function(){},a.cpm.Module.prototype.sync=function(a,b){alert("no save function yet, you have to modify the source file by directly in the server files")},a.cpm.Module.confToYaml=function(a){var b="";for(var c in a)b+=c+" : "+a[c]+"\n";return b},a.cpm.Module.prototype.run=function(b,c,d){var e=this;console.log(b),$.ajax({type:"POST",data:{cmd:"module run "+e.def.modulename,data:a.cpm.Module.confToYaml(b)},url:e.app.options.cpmbaseurl+"rest/cmd",dataType:"text",success:function(d,f,g){var h=d,i=e.app.view.createPanel(e.def.modulename+" (run "+h+")");new a.cpm.Process(e.app,i.find(".frame-body"),{moduledef:e.def.module,runconf:b,runid:h});c.call(e.view)},error:function(){}})}}(window.vw=window.vw||{}),function(a){a.cpm.ModuleManager=function(b,c,d){this.options=d,this.app=b,this.view=new a.cpm.ModuleManagerView(this,c),this.init(),this.moduletree={},this.modules={},this.modulesobj=[]},a.cpm.ModuleManager.prototype.init=function(){var a=this;a.fetchAll()},a.cpm.ModuleManager.prototype.fetchAll=function(){var a=this;$.ajax({type:"POST",url:a.app.options.cpmbaseurl+"rest/cmd",data:{cmd:"module ls --json"},dataType:"json",success:function(b,c,d){a.moduletree=b,a.parseModuleTree(b),a.view.refresh()}})},a.cpm.ModuleManager.prototype.parseModuleTree=function(a){if("object"==typeof a)if(a.constructor===Array)for(var b=a.length-1;b>=0;b--)this.parseModuleTree(a[b]);else a.hasOwnProperty("folder")&&a.folder?this.parseModuleTree(a.items):this.modules[a.modulename]=a},a.cpm.ModuleManager.prototype.fetch=function(a,b){var c=this;$.ajax({type:"POST",url:c.app.options.cpmbaseurl+"rest/cmd",data:{cmd:"module info "+a+" --json"},dataType:"json",success:function(a,d,e){b.call(c,a)}})}}(window.vw=window.vw||{}),function(a){a.cpm.Process=function(b,c,d){this.app=b,this.init(d),this.view=new a.cpm.ProcessView(this,c),this.synced=!1},a.cpm.Process.prototype.init=function(a){this.moduledef=a.moduledef,this.conf=a.runconf,this.runid=a.runid},a.cpm.Process.prototype.fetch=function(){},a.cpm.Process.prototype.sync=function(a,b){alert("no save function yet, you have to modify the source file by directly in the server files")},a.cpm.Process.prototype.run=function(a,b,c){var d=this;console.log(a),b&&b.call(d.view)}}(window.vw=window.vw||{}),function(a){a.cpm.ProcessManager=function(b,c,d){this.options=d,this.app=b,this.view=new a.cpm.ProcessManagerView(this,c),this.init(),this.runs={}},a.cpm.ProcessManager.prototype.init=function(){var a=this;a.fetchAll()},a.cpm.ProcessManager.prototype.fetchAll=function(a,b){var c=this;$.ajax({type:"POST",url:c.app.options.cpmbaseurl+"rest/cmd",data:{cmd:"process ls -a"},dataType:"text",success:function(a,b,d){var e=a.split("\n");for(var f in e){var g=e[f].trim();if(""!=g){var h=g.split(":");c.runs.hasOwnProperty(h[0])?c.runs[h[0]].push(h[1]):c.runs[h[0]]=[h[1]]}}c.view.refresh()}})}}(window.vw=window.vw||{}),function(a){a.cpm.CLIView=function(a,b){this.$el=b,this.el=b[0],this.model=a,this.init(),this.panels=[]},a.cpm.CLIView.maxFrameHeight=500,a.cpm.CLIView.prototype.init=function(){var b=this;this.$fullscreencontainer=$(a.cpm.CLIView.fullscreentemplate),$("body").append(this.$fullscreencontainer),a.cpm.CLIView.maxFrameHeight=$(window).height()-178,$("#cmd-bar-container").perfectScrollbar({suppressScrollX:!0}),$("#active-content").css("height",window.innerHeight-94),$("#active-content").perfectScrollbar(),$("#menu-content-body").css("height",window.innerHeight-80),$("#menu-content-body").perfectScrollbar({suppressScrollX:!0}),$(window).on("resize",function(){$("#menu-content-body").css("height",window.innerHeight-80),$("#menu-content-body").perfectScrollbar({suppressScrollX:!0}),$("#active-content").css("height",window.innerHeight-94),$("#active-content").perfectScrollbar(),a.cpm.CLIView.maxFrameHeight=$(window).height()-178}),this.contentpanel=$("#active-content"),this.cmdbar=$("#cmdbar").cmd({prompt:"$",width:"100%",commands:function(a){b.model.request($("<div>"+a+"</div>").text())}}),$("#cmdbar").on("mousedown",function(c){2==c.which&&a.cpm.currentTextSelection&&(b.cmdbar.insert(a.cpm.currentTextSelection),b.toggleCLI(!0))}),jQuery("#menu").click(function(){b.toggleCLI(!1)}),jQuery("#app-title").click(function(){b.toggleCLI(!1),jQuery("#main").hasClass("menu-closed")&&(b.model.activemenu="default",b.model.setActiveMenu("default")),jQuery(".menu-open").switchClass("menu-open","menu-closed"),jQuery(".menu-closed").switchClass("menu-closed","menu-open")}),$(".main-menu-item").click(function(){b.model.activemenu==this.id?(jQuery(".menu-open").switchClass("menu-open","menu-closed"),jQuery(".menu-closed").switchClass("menu-closed","menu-open")):(jQuery(".menu-closed").switchClass("menu-closed","menu-open"),b.model.setActiveMenu(this.id),b.model.activemenu=this.id)}),jQuery("#active-content").on("click",function(){b.toggleCLI(!1)}),jQuery("#cmd-bar-container").on("click",function(){b.toggleCLI(!0)})},a.cpm.CLIView.prototype.toggleCLI=function(a){a?this.cmdbar.isenabled()||(this.cmdbar.enable(),this.cmdbar.focus()):this.cmdbar.isenabled()&&this.cmdbar.disable()},a.cpm.CLIView.prototype.stick=function(a){var b=this;a.detach(),this.contentpanel.find("#active-content-sticky").append(a);var c=a.find(".frame-tool-pin");c.removeClass("frame-tool-pin"),c.addClass("frame-tool-unpin"),c.unbind("click"),c.click(function(){b.unstick(a)})},a.cpm.CLIView.prototype.unstick=function(a){var b=this;a.detach(),this.contentpanel.find("#active-content-flow").append(a);var c=a.find(".frame-tool-unpin");c.removeClass("frame-tool-unpin"),c.addClass("frame-tool-pin"),c.unbind("click"),c.click(function(){b.stick(a)})},a.cpm.CLIView.prototype.getPanel=function(a,b){var c=this,d=-1;for(var e in c.panels)if(c.panels[e].find(".frame-title").html()==a){d=e;break}return-1!=d?c.panels[e]:b?void 0:c.createPanel(a)},a.cpm.CLIView.prototype.quitFullscreen=function(a){var b=this;b.$fullscreencontainer.fadeOut();var c=b.$fullscreencontainer.find(".frame-title").children();0==c.length&&a.find(".frame-title").append(c);var d=b.$fullscreencontainer.find(".frame-body").children();0!=d.length&&a.find(".frame-body").append(d)},a.cpm.CLIView.prototype.fullscreen=function(a){var b=this;b.$fullscreencontainer.fadeIn();var c=a.find(".frame-title").children();0==c.length&&(c=a.find(".frame-title").html());var d=a.find(".frame-body").children();0==d.length&&(d=a.find(".frame-body").html()),b.$fullscreencontainer.find(".frame-title").empty(),b.$fullscreencontainer.find(".frame-body").empty(),b.$fullscreencontainer.find(".frame-title").append(c),b.$fullscreencontainer.find(".frame-body").append(d),b.$fullscreencontainer.find(".frame-tool-quitfs").unbind("click"),b.$fullscreencontainer.find(".frame-tool-quitfs").on("click",function(){b.quitFullscreen(a)})},a.cpm.CLIView.prototype.show=function(a){var b=this,c=a.find(".frame-tool-show");c.removeClass("frame-tool-show"),c.addClass("frame-tool-hide"),c.unbind("click"),a.find(".frame-body").slideDown({complete:function(){c.on("click",function(){b.hide(a)})}})},a.cpm.CLIView.prototype.hide=function(a){var b=this,c=a.find(".frame-tool-hide");c.removeClass("frame-tool-hide"),c.addClass("frame-tool-show"),c.unbind("click"),a.find(".frame-body").slideUp({complete:function(){c.on("click",function(){b.show(a)})}})},a.cpm.CLIView.prototype.createPanel=function(b,c){var d=this,e=a.cpm.CLIView.frametemplate,f=$(e);return this.contentpanel.find("#active-content-flow").prepend(f),"undefined"!=b&&f.find(".frame-title").append(b),"undefined"!=c&&f.find(".frame-body").append(c),this.panels.push(f),f.find(".frame-title").mouseup(function(b){a.cpm.currentTextSelection=a.cpm.utils.getSelectionText()}),f.find(".frame-body").mouseup(function(b){a.cpm.currentTextSelection=a.cpm.utils.getSelectionText()}),f.find(".frame-tool-pin").click(function(){d.stick(f)}),f.find(".frame-tool-close").click(function(){var a=d.panels.indexOf(f);-1!=a&&d.panels.splice(a,1),f.remove()}),f.find(".frame-tool-openfs").click(function(){d.fullscreen(f)}),f.find(".frame-tool-hide").click(function(){d.hide(f)}),f},a.cpm.CLIView.frametemplate='<div class="frame"><div class="frame-header"><div class="frame-title"></div><div class="frame-tools"><div class="frame-tool frame-tool-close"></div><div class="frame-tool frame-tool-pin"></div><div class="frame-tool frame-tool-openfs"></div><div class="frame-tool frame-tool-hide"></div></div></div><div class="frame-body"></div></div>',a.cpm.CLIView.fullscreentemplate='<div id="fullscreen-container"><div class="frame-header"><div class="frame-title"></div><div class="frame-tools"><div class="frame-tool frame-tool-quitfs"></div></div></div><div class="frame-body"></div></div>'}(window.vw=window.vw||{}),function(a){function b(a,b){var c=typeof a,d=typeof b;return a.hasOwnProperty("...")?-1:b.hasOwnProperty("...")?1:c!=d?"string"==c?-1:"string"==d?1:0:0}a.cpm.CorpusManagerView=function(a,b){this.$el=b||$("<div></div>"),this.el=this.$el[0],this.model=a,this.init()},a.cpm.CorpusManagerView.prototype.init=function(){},a.cpm.CorpusManagerView.prototype.refresh=function(){var b=this;this.$el.html(a.cpm.CorpusManagerView.renderSubTree(this.model.filetree,0,b.model.app.cpmsettingsmanager.cpmsettings.corpus_dir)),this.$el.find(".treeview-node").on("click",function(){var a=$(this).parent();if(a.hasClass("treeview-fold")){var b=a.children();a.hasClass("treeview-folded")?($(b[1]).slideDown(),a.removeClass("treeview-folded"),a.addClass("treeview-unfolded")):($(b[1]).slideUp(),a.removeClass("treeview-unfolded"),a.addClass("treeview-folded"))}}),this.$el.find(".treeview-node").draggable({appendTo:"body",opacity:.7,helper:"clone"})},a.cpm.CorpusManagerView.renderSubTree=function(c,d,e){var f="";if("object"==typeof c)if(c.constructor===Array){c=c.sort(b);for(var g=c.length-1;g>=0;g--)f+=a.cpm.CorpusManagerView.renderSubTree(c[g],d,e)}else for(var g in c)if("..."==g)f+="file"==c[g]?'<div class="treeview-leaf treeview-more" style="margin-left:'+d+'px;" filepath="'+e+'">'+g+"</div>":'<div class="treeview-node treeview-more" style="margin-left:'+d+'px;" filepath="'+e+'">'+g+"</div>";else{var h="treeview-folded",i='style="display:none;"';0==d&&(h="treeview-unfolded",i=""),f+='<div class="treeview-fold '+h+'"><div class="treeview-node" style="margin-left:'+d+'px;" filepath="'+e+g+'">'+g+"</div><div "+i+">"+a.cpm.CorpusManagerView.renderSubTree(c[g],d+14,e+g+"/")+"</div></div>"}else"string"==typeof c&&(f+='<div class="treeview-leaf" style="margin-left:'+d+'px;" filepath="'+e+c+'">'+c+"</div>");return f}}(window.vw=window.vw||{}),function(a){a.cpm.CPMSettingsManagerView=function(b,c){this.id=a.cpm.utils.guid(),this.$el=c||$("<div></div>"),this.el=this.$el[0],this.model=b,this.init()},a.cpm.CPMSettingsManagerView.prototype.init=function(){},a.cpm.CPMSettingsManagerView.prototype.render=function(){var a=this.model.cpmsettings,b="";b+='<div class="settings-field-title"> Corpus directory : </div><div class="settings-field-body">'+a.corpus_dir+"</div>",b+='<div class="settings-field-title"> Result directory : </div><div class="settings-field-body">'+a.result_dir+"</div>";for(var c='<div class="settings-field-title"> Modules directories :</div><div class="settings-field-body"><ul>',d=a.modules.length-1;d>=0;d--)c+="<li ",c+=a.modules[d].exist?">":'class="warning-field">',c+=a.modules[d].name+"</li>";c+="</ul></div>",b+=c,this.$el.append(b)}}(window.vw=window.vw||{}),function(a){a.cpm.HelpManagerView=function(b,c){this.id=a.cpm.utils.guid(),this.$el=c||$("<div></div>"),this.el=this.$el[0],this.model=b,this.init()},a.cpm.HelpManagerView.prototype.init=function(){var b=this;this.$el.append(a.cpm.HelpManagerView.template),this.$el.find("#help-module-doc").on("click",function(){b.model.app.view.createPanel("Modules doc page",'<iframe width="100%" height="'+a.cpm.CLIView.maxFrameHeight+'px;" style="border:none;" src="https://versatile-world.net/wiki/work/cpm/spec_draft?rev=1445003156&mddo=print">')}),this.$el.find("#help-main-wiki-page").on("click",function(){b.model.app.view.createPanel("Main wiki page",'<iframe width="100%" height="'+a.cpm.CLIView.maxFrameHeight+'px;" style="border:none;" src="https://versatile-world.net/wiki/work/cpm">')})},a.cpm.HelpManagerView.template='<div id="help-main-wiki-page" style="cursor:pointer;">Main wiki</div><div id="help-module-doc" style="cursor:pointer;">Modules</div>'}(window.vw=window.vw||{}),function(a){function b(a,b){var c=typeof a,d=typeof b;return a.hasOwnProperty("folder")&&a.folder?1:b.hasOwnProperty("folder")&&b.folder?-1:c!=d?"string"==c?-1:"string"==d?1:0:0}a.cpm.ModuleManagerView=function(b,c){this.id=a.cpm.utils.guid(),this.$el=c||$("<div></div>"),this.el=this.$el[0],this.model=b,this.init()},a.cpm.ModuleManagerView.prototype.init=function(){},a.cpm.ModuleManagerView.prototype.refresh=function(){var b=this;this.$el.html(a.cpm.ModuleManagerView.renderSubTree(this.model.moduletree,0)),this.$el.find(".treeview-node").on("click",function(){var a=$(this).parent();if(a.hasClass("treeview-fold")){var b=a.children();a.hasClass("treeview-folded")?($(b[1]).slideDown(),a.removeClass("treeview-folded"),a.addClass("treeview-unfolded")):($(b[1]).slideUp(),a.removeClass("treeview-unfolded"),a.addClass("treeview-folded"))}}),this.$el.find(".treeview-leaf").on("click",function(){var c=$(this).html(),d=b.model.app.view.createPanel(c),e=new a.cpm.Module(b.model.app,d.find(".frame-body"),b.model.modules[c]);b.model.modulesobj.push(e),e.view.render()}),this.$el.find(".treeview-leaf").draggable({appendTo:"body",opacity:.7,helper:"clone"}),this.$el.find(".treeview-leaf").droppable()},a.cpm.ModuleManagerView.renderSubTree=function(c,d){var e="";if("object"==typeof c)if(c.constructor===Array){c=c.sort(b);for(var f=c.length-1;f>=0;f--)e+=a.cpm.ModuleManagerView.renderSubTree(c[f],d)}else if(c.hasOwnProperty("folder")&&c.folder){var g="treeview-folded",h='style="display:none;"';g="treeview-unfolded",h="",e+='<div class="treeview-fold '+g+'"><div class="treeview-node" style="margin-left:'+d+'px;">'+c.foldername+"</div><div "+h+">"+a.cpm.ModuleManagerView.renderSubTree(c.items,d+14)+"</div></div>"}else e+=c.hasOwnProperty("module")?'<div class="treeview-leaf" style="margin-left:'+d+'px;">'+c.module.name+"</div>":'<div class="treeview-leaf" style="margin-left:'+d+'px; color:red;">'+c.modulename+"</div>";return e}}(window.vw=window.vw||{}),function(a){a.cpm.ModuleView=function(b,c){this.id=a.cpm.utils.guid(),this.$el=c||$("<div></div>"),this.el=this.$el[0],this.model=b,this.init()},a.cpm.ModuleView.prototype.init=function(){var b=this;this.$el.append(a.cpm.ModuleView.template),b.model.def.hasOwnProperty("module")?b.renderGraphical():b.$el.find(".module-content-view").append(b.model.def.source.replace(/(?:\r\n|\r|\n)/g,"<br>").replace(/(?:\s)/g,"&nbsp;")),b.setActiveMenu(".module-view-graphic"),this.$el.find(".module-view-source").on("click",function(){b.$el.find(".module-content-view").empty(),b.$el.find(".module-content-view").append(b.model.def.source.replace(/(?:\r\n|\r|\n)/g,"<br>").replace(/(?:\s)/g,"&nbsp;")),b.setActiveMenu(".module-view-source")}),this.$el.find(".module-view-graphic").on("click",function(){b.showGraphical(),b.setActiveMenu(".module-view-graphic")}),this.$el.find(".module-save").on("click",function(){b.model.sync(function(){},function(){})}),this.$el.find(".module-run").on("click",function(){b.$el.find(".module-content-view").empty(),b.renderRunConfForm(),b.setActiveMenu(".module-run")})},a.cpm.ModuleView.prototype.setActiveMenu=function(a){this.$el.find(".module-header-item").removeClass("active"),this.$el.find(a).addClass("active")},a.cpm.ModuleView.prototype.render=function(){},a.cpm.ModuleView.prototype.renderRunConfForm=function(){var a=this;$form=$("<div></div>");var b=a.model.def.module.input;for(var c in b)$form.append('<div class="module-run-conf-form-field"><span style="font-weight:bold">'+c+'</span><span style="font-style:italic;"> ('+b[c].type+')</span><input type="text" value="" name="'+c+'"></div>');$form.append('<center><button class="submit" type="button">Run</button></center>'),this.$el.find(".module-content-view").append($form),$form.find("input").droppable({drop:function(a,b){$(this).val(b.draggable.attr("filepath"))}}),$form.find(".submit").on("click",function(){var c={};for(var d in b)c[d]=$form.find('input[name="'+d+'"]').val();a.model.run(c,function(){a.showGraphical(),a.setActiveMenu(".module-view-graphic")})})},a.cpm.ModuleView.prototype.showGraphical=function(){var a=this;a.$el.find(".module-content-view").empty(),a.model.def.hasOwnProperty("module")?a.renderGraphical():a.$el.find(".module-content-view").append("Unable to display graphical view of this module, definition contains error, please correct source file before")},a.cpm.ModuleView.prototype.renderGraphical=function(){var a=this;this.$el.find(".module-content-view").append('<div id="'+this.id+'" class="canvas-view"></div>'),a.canvas=new draw2d.Canvas(a.id),a.canvas.onDrop=function(b,c,d,e,f){var g=new draw2d.shape.basic.Rectangle;a.canvas.add(g,100,10)};var b=new draw2d.shape.basic.Rectangle;a.canvas.add(b,100,10)},a.cpm.ModuleView.template='<div class="module-header"><span class="module-view-source module-header-item" style="float:left; margin-left:8px;">source</span><span class="module-view-graphic module-header-item" style="float:left; margin-left:20px;">view</span><span class="module-run module-header-item" style="float:right; margin-right:8px;">run</span><span class="module-save module-header-item" style="float:right; margin-right:20px;">save</span></div><div class="module-content-view"></div>'}(window.vw=window.vw||{}),function(a){a.cpm.ProcessManagerView=function(a,b){this.$el=b||$("<div></div>"),this.el=this.$el[0],this.model=a,this.init()},a.cpm.ProcessManagerView.prototype.init=function(){},a.cpm.ProcessManagerView.prototype.refresh=function(){var a=this,b="";for(var c in a.model.runs){b+="<div>"+c+"</div><ul>";for(var d in a.model.runs[c])b+="<li>"+a.model.runs[c][d]+"</li>";b+="</ul>"}a.$el.empty(),a.$el.append(b)}}(window.vw=window.vw||{}),function(a){a.cpm.ProcessView=function(a,b){this.$el=b||$("<div></div>"),this.el=this.$el[0],this.model=a,this.init()},a.cpm.ProcessView.prototype.init=function(){this.$el.append(a.cpm.ProcessView.template)},a.cpm.ProcessView.prototype.render=function(){console.log(this.model)},a.cpm.ProcessView.template="Hello World!"}(window.vw=window.vw||{});